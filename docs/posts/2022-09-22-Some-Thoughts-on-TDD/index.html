<!doctype html><html><head><title>Some Thoughts On TDD | ðŸ“’ Functional Fieldnotes</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.1/highlight.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.1/languages/elm.min.js"></script><script>hljs.initHighlightingOnLoad();</script><link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.1/styles/default.min.css" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Open+Sans|Proza+Libre|Inconsolata" rel="stylesheet" type="text/css"></head><body><div style="display: flex; flex-direction: row; flex-wrap: wrap; justify-content: space-between; align-items: center;" class="navigation"><div style="display: flex;"><a href="/posts">Functional Fieldnotes</a></div><div style="display: flex; flex-direction: row; flex-wrap: wrap; gap: 16px;"></div></div><div class="sidebar"><div style="display: flex; flex-direction: column; padding: 8px; float: right;"><h2>Posts</h2><ul><li><a href="/posts/2022-10-26-Reading:-Clean-Architecture">Reading: Clean Architecture</a></li><li><a href="/posts/2022-10-20-Reading:-The-Clean-Coder">Reading: The Clean Coder</a></li><li><a href="/posts/2022-10-19-Reading:-Clean-Code">Reading: Clean Code</a></li><li><a href="/posts/2022-10-19-Comparing-Elm-With-Kotlin">Comparing Elm With Kotlin</a></li><li><a href="/posts/2022-10-11-formal-methods,-type-theory-and-the-real-world">Formal Methods, Type Theory And The Real World</a></li><li><a href="/posts/2022-10-11-Relearn-CSS">Relearn CSS</a></li><li><a href="/posts/2022-10-08-investigating-design-patterns">Investigating Design Patterns</a></li><li><a href="/posts/2022-10-06-functional-design-patterns">Functional Design Patterns</a></li><li><a href="/posts/2022-10-06-exploring-monads">Exploring Monads</a></li><li><a href="/posts/2022-10-05-simple-software">Simple Software</a></li><li><a href="/posts/2022-09-22-Some-Thoughts-on-TDD">Some Thoughts On TDD</a></li><li><a href="/posts/2022-09-18-Tracery-Language">Tracery Language</a></li><li><a href="/posts/2022-07-27-Terminology-Overview">Terminology Overview</a></li><li><a href="/posts/2022-05-29-Reading:-The-Pragmatic-Programmer">Reading: The Pragmatic Programmer</a></li></ul></div></div><div class="sidebar2"><div style="display: flex; flex-direction: column; position: sticky; top: 0px; padding: 8px;"><h2>Table of Content</h2><ol><li><a href="#What_is_TDD">What is TDD</a><ol></ol></li><li><a href="#Reasons_against_TDD">Reasons against TDD</a><ol><li><a href="#Mocking_leads_to_false_assumtions">Mocking leads to false assumtions</a><ol></ol></li><li><a href="#Code_Coverage_of_80__does_not_come_naturally">Code Coverage of 80% does not come naturally</a><ol></ol></li><li><a href="#Harder_to_refactor">Harder to refactor</a><ol></ol></li><li><a href="#Longer_Pipeline_Time">Longer Pipeline Time</a><ol></ol></li></ol></li></ol></div></div><div class="content"><h1 class="title">Some Thoughts On TDD</h1><div class="post-metadata"><span>2022-09-22</span><span>â€¢</span><a href="/tags/elm">Elm</a><a href="/tags/functional programming">Functional Programming</a><a href="/tags/tdd">Tdd</a></div><div class="markdown"><p>tltr;</p><ul><li>Make less tests with higher coverage.</li><li>Write that are more valuable than the time they take to run.</li><li>Use tests as requirements not as documentation.</li></ul><h1 id="What_is_TDD">What is TDD</h1><p>The core idea of TDD is to first write down your requirements as tests and then implement them. If all tests passed, then you can assume that you implemented a correct soluction.</p><p><a href="https://www.youtube.com/watch?v=EZ05e7EMOLM">Video: Ian Cooper - TDD, Where did it all go wrong</a>
<a href="https://open.spotify.com/episode/5Pkv1z1jwix8sVXPj1yqBD?si=FccsNh9KSnmhVtKTDKMdJw">Daniel Terhorst-North about the creation of BDD</a></p><p>"Behaviour Driven Development" will often be used to empathis this.</p><p>This style is very hard to actually pull off, as you are required to actually have requirements in form of tests to begin with.</p><p>Thats why the industry mostly uses TDD as a synonym for a high code coverage.</p><h1 id="Reasons_against_TDD">Reasons against TDD</h1><p>From my experience the original intend of TDD was been completely lost:
If someone says they develop test driven, then they don't mean that they start with test and that they see their tests as some form of specification.
Rather, I noticest that what they actually mean is that they try to have a high test coverage - usually at about 80%.
They try to create as many tests as possible - even if some tests overlap - as long as it increases the test coverage.
And once they notice that a test fails, they rewrite it so that it works again. This in particular really cracks me up.
Either my test are the specification, in that case i should write them once and then hopefully never ever touch them again,
or they document my current behaviour but then i should only write them after im done - together with other forms of documentation.</p><p>I once had a PR rejected because I had not touched a test.
The reviewer assumed that i was impossible for me to change something without breaking at least one test.
But the change itself was a fix for a bug that only occured on a specific date at a specific time - of course non of the existing test had covered that.
We had an argument about it. He wanted me to add a test where i unit test that specific timestamp.
I was against it as it was not a edge case in the specification - just some error that occured because our original algorithm was wrong.</p><p>This incident really got me thinking. In a sense we both where correct, but we clearly had different views as to what our tests represented.
I would want to believe that there is a place in between, where tests represent the specification but also cover a lot of the code. It might not be 80% though.
I'm still uncertain if a high code coverage is actually useful. Mostly because whenever i've seen a code coverage of 80%, it invoved a lot of (sloppy) mocks.
Creating Mocked tests is always a double edged sword, because you need to be certain that your mocked data is acutally correct.
Invalid mocks can validate everything.
I have, however, also managed a full test coverage without mocks - ok, i must clearify, i used a pure fuctional programming language (Elm).
So there would not really have been anything that needed mocking. But still.
I do acutally believe that functional programming requires less tests then OOP.
My guess for a reason, why this might be the case, would be the more expressive type system.
A type annotation is in a sense a proof (see Curryâ€“Howard correspondence). So i somehow see a relation to the whole validate vs verify topic.
But that a topic for another day.</p><h2 id="Mocking_leads_to_false_assumtions">Mocking leads to false assumtions</h2><p>Mocking is needed to acutally archive TDD but this might result in false mocks. But writing tests without mocks can be done. The solution is to seperate effects from logic and then only test the logic. To tests effect we can use system tests.</p><h2 id="Code_Coverage_of_80__does_not_come_naturally">Code Coverage of 80% does not come naturally</h2><p>I've never seen anyone actually do TDD in a way where they end up with a code coverage of 80% by their first attempt. Most often you have around 50% by the first try, then check your code coverage and create the missing tests. Thats because a lot of tests are useless(Mocking a lot with no real data) or testing unwanted behaviour(Fail states).</p><h2 id="Harder_to_refactor">Harder to refactor</h2><p>If you go for a bottom-up approach, then you are also directly testing implementation decitions. This means whenever you want to switch to a different implementation, you will have to adapt or rewrite all associated tests.</p><h2 id="Longer_Pipeline_Time">Longer Pipeline Time</h2><p>A project with a code coverage of 80% or a bottom-up-TDD approach will take much longer as to complete the pipeline. This slows down development my a massive amount. It's not only that the CD/CI process takes longer, developers are thrown out of their flow if they have to wait 30 to 60min just to see if the PR is green or not.</p><hr><p>Did you like this post or want to share some thoughts? Then ping me on <a href="https://discourse.elm-lang.org/u/lucas_payr">Elm Discourse</a>.</p></div></div><div style="display: flex; flex-direction: row; flex-wrap: wrap; justify-content: space-between;" class="footer"><div style="display: flex;"></div><div style="display: flex; flex-direction: row; flex-wrap: wrap; gap: 16px; align-items: center;"><div style="display: flex;" class="link"><a href="https://www.linkedin.com/in/lucas-payr-8462911b9/">Build by Lucas Payr</a></div><div style="display: flex;" class="link"><a href="https://github.com/Orasund" style="display: flex; justify-content: center; align-items: center;"><svg width="32" height="32" viewbox="0 0 16 16"><path fill="#fff" d="
M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z
            "></path></svg></a></div><div style="display: flex;" class="link"><a href="https://twitter.com/edzgou" style="display: flex; justify-content: center; align-items: center;"><svg width="32" height="32" viewbox="0 0 16 16"><path fill="#fff" d="
M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809 c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z
            "></path></svg></a></div></div></div><link href="/styles.css" rel="stylesheet" type="text/css"><style>body {
    padding:0px;
    margin:0px;
    background-color:#fffbf8;
    color:#363636;
    font-family:Open Sans, Arial, sans-serif;
    font-size:18px;
    line-height:32px;
}

a {
    color:#348aa7;
    text-decoration:none;
}

code {
    font-family:Inconsolata, monospace;
    border-radius:8px;
}

h1, h2, h3, h4, h5, h6 {
    font-family:Proza Libre, Helvetica, sans-serif;
    line-height:32px;
    margin-left:-8px;
    margin-right:-8px;
}

.title {
    font-size:32px;
    margin-block-start:0px;
    margin-block-end:64px;
    height:inherit;
    padding-left:16px;
    padding-right:16px;
    margin-left:-24px;
    margin-right:-24px;
}

h1 {
    font-size:24px;
    border-bottom:1px solid #363636;
    margin-block-start:64px;
    margin-block-end:32px;
    box-sizing:border-box;
    height:32px;
}

h2 {
    font-size:22px;
    margin-bottom:0.80808rem;
    margin-block-start:32px;
    margin-block-end:32px;
}

h3, h5, h6 {
    font-size:1em;
    margin-block-start:32px;
    margin-block-end:0px;
}

small {
    font-size:65%;
}

ul {
    padding-inline-start:30px;
}

ol {
    padding-inline-start:30px;
}

p {
    margin-block-start:32px;
    margin-block-end:32px;
    text-align:justify;
}

.sidebar, .sidebar2 {
    font-size:0.9em;
    padding-top:64px;
}

.sidebar  h1, .sidebar  h2, .sidebar  h3, .sidebar2  h1, .sidebar2  h2, .sidebar2  h3 {
    margin:0;
}

.navigation {
    text-align:center;
    background-color:#a7e9ff;
    padding:16px;
}

.content {
    max-width:100vw;
    padding:32px 40px;
    background-image:linear-gradient(#a7e9ff 1px, transparent 0), linear-gradient(90deg, #a7e9ff 1px, transparent 0);
    background-size:32px 32px;
}

.footer {
    text-align:center;
    background-color:#348aa7;
    color:#ffffff;
    padding:16px;
}

.footer  a {
    color:#ffffff;
    text-decoration:none;
}

.footer  svg {
    padding-right:5px;
    vertical-align:baseline;
}

.post-metadata {
    height:32px;
    margin-top:32px;
    margin-bottom:32px;
}

.post-metadata  a, .post-metadata  span {
    display:inline-block;
    margin-right:5px;
}

.post-metadata  a {
    border-radius:16px;
    background-color:#348aa7;
    color:#fff;
    padding-left:8px;
    padding-right:8px;
    line-height:24px;
}</style></body></html>